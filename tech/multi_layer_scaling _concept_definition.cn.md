Hacash 多层扩容模型概念解释
===

Hacash 白皮书几乎一半的篇幅在描述一种新型的点对点支付技术：通道链支付结算网络。这项技术是将中间过程的支付放在链下进行，并最终在链上结算的二层扩容方案。另外，明确指出分层扩容才是区块链的未来，这一预言性思想也来自这份 2018 年发布的白皮书。

通道链网络已经在 2021 年初步开发完成，并已经在主网启用，可以视之为 Layer2 网络。基于 Hacash 这种分层扩容的指导理念，社区也提出了 Layer3 多链扩容方案，目前主要由 Hacash.com 团队推动。

我们将从多个维度对比 L1 、L2 和 L3 这三个区块链层级的各方面特质，并理清楚各自的概念定义，一方面作为过去社区讨论的总结，另一方面希望为 Hacash 今后在扩容技术领域的讨论奠定理论基础。

以传统互联网技术视角来看，区块链系统的执行过程可以分为计算、验证和状态共识三个步骤：通过一笔交易包含的内容（转账或合约调用）去计算出交易执行完毕之后的状态，随后通过对比状态数据验证计算结果的正确性或有效性，最终通过挖矿等共识机制让全网达成交易执行之后的状态共识，一个完整的区块链执行流程结束。我们分别以这三步去考察  L1、L2 和 L3 定义：

|层级|主网计算|主网验证|主网共识|
| --- | --- | --- | --- |
|L1|✅|✅|✅|
|L2|❌|✅|✅|
|L3|❌|❌|✅|

其中 L1 就是主网本身，所有其计算、验证和共识都在主网上进行。L2 也就是通道链网络由于把支付过程放到了链下进行，也就是其计算过程发生在主网之外，但最后的结算和仲裁也就是支付的有效性验证还是在主网进行，由于 L2 支付的是主网支持的资产，则相应的其状态共识也在链上进行。L3 存在的目标是为了满足更大的交易业务处理性能，那么受限于主网的状态空间限制，其计算和有效性验证（账本数据）都必然应该在主网外进行，但为了利用到主网强大的安全性， L3 应该通过各种方式将链外状态变更的共识过程（状态根）体现在链上。

那么还会有 L4 的定义吗？可以看出从上面的定义解释过程来说，不可能存在 L4 这个概念了。因为按上面的表格推论意味着 L4 的状态共识过程也不发生在主网之上，这已经完全区块链系统没有任何关系了。

以上对 L3 概念的定义，和 Vitalik 的后来提到的以太坊 Layer3 定义有所区别。为简化论述，我们把 Vitalik 提的 L3 简称 V-L3，Hacash的 L3 简称 H-L3 。

简单来说 ，V-L3 是一种以 L2 为结算层的“分形二层网络”，而不与主网  L1 层发生任何关联，层与层之间区分更加严格。本质上来说， Vitalik 所说的 L2-L3 的概念对应关系是 L1-L2 之间关系的一种重复。如此一来， 以太坊语境下  L4 、L5 甚至更多层的出现都有理论可能性。而 H-L3 则更加灵活， L1，L2和其它L3 都能作为H-L3的基础层，所以不会再有 L4 层了，或者说所有 L4、L5、L6 ... 等等层都统一叫做 H-L3 层。

除了这个维度的差异， V-L3 与 H-L3 有着更多的共同点：

1. L3 是多链、多应用系统，而不是一条链，甚至可也称之为 APP-Chain

2. L3 能灵活选择不一样的共识技术、合约引擎或特定的加密算法等用于单个、独立的用途

3. L1 是完全去中心化+无信任层，L2 为半去中心化+无信任层，L3 是可选择的去中心化+弱信任层。层级越高，交易处理性能和灵活性提升，去中心化程度、免信任程度下降

4. L2 和 L3 有不同的用途，L3 并不是简单的“在L2上再来一个L2”

5. 多数跨链功能无需与 L1 层交互

通过 L1 、L2  和  L3 三层结构解决了区块链系统的可扩展性问题和可编程问题，那么 L1 层的分片扩容和图灵完备的智能合约存在意义将被严重削弱，优势将不足以覆盖其缺陷。




